# TAPO C210 Monitor

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—          â•‘
â•‘   â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•—         â•‘
â•‘      â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘         â•‘
â•‘      â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘         â•‘
â•‘      â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•         â•‘
â•‘      â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•      â•šâ•â•â•â•â•â•      â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•          â•‘
â•‘                                                                               â•‘
â•‘                    ğŸ¥ Intelligent Camera Monitor ğŸ¥                            â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

AI-powered monitoring system for TP-Link TAPO C210 WiFi camera with **direct RTSP streaming** and **Android automation** for PAN/TILT control.

## âœ… Status: RTSP Working!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RTSP STREAMING ACTIVE                       â”‚
â”‚                                                                 â”‚
â”‚   Camera â”€â”€â”€â”€â”€â”€â”€â”€â–º RTSP â”€â”€â”€â”€â”€â”€â”€â”€â–º Your Computer                 â”‚
â”‚   192.168.29.183   Port 554      ffmpeg/VLC/Python              â”‚
â”‚                                                                 â”‚
â”‚   Resolution: 2304x1296 HD â”‚ Codec: H.264 â”‚ FPS: 25             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Pan Control Experiment                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   [RTSP Stream]                [Android Emulator]               â”‚
â”‚   Direct Video                 PAN/TILT Control                 â”‚
â”‚        â”‚                              â”‚                         â”‚
â”‚        â–¼                              â–¼                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ ffmpeg  â”‚                  â”‚  Tapo App   â”‚                  â”‚
â”‚   â”‚ frame   â”‚                  â”‚  ADB taps   â”‚                  â”‚
â”‚   â”‚ capture â”‚                  â”‚             â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚        â”‚                              â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â–¼                                         â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚        â”‚    Visual Change Detection       â”‚                      â”‚
â”‚        â”‚  (Compare frames before/after)   â”‚                      â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                       â”‚                                         â”‚
â”‚                       â–¼                                         â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚        â”‚      Claude Agent SDK            â”‚                      â”‚
â”‚        â”‚   (Interpret & Take Actions)     â”‚                      â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¸ Screenshots

| Home Screen | PTZ Controls |
|-------------|--------------|
| ![Home](ui-exploration/screenshots/camera-offline-home-screen.png) | ![PTZ](ui-exploration/screenshots/camera-live-ptz-panel-open.png) |

## ğŸš€ Quick Start

### 1. Mobile App Setup (Required First!)

Open the **Tapo app** on your phone and follow these steps:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ“± MOBILE APP SETUP                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  STEP 1: Enable Third-Party Compatibility                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚  ğŸ“ Me tab â†’ Settings (gear icon) â†’ Third-Party Compatibility   â”‚
â”‚  âœ… Toggle ON                                                   â”‚
â”‚  âš ï¸  Accept the privacy warning dialog                          â”‚
â”‚                                                                 â”‚
â”‚  STEP 2: Create Camera Account (RTSP credentials)               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  ğŸ“ Home â†’ Tap camera â†’ Settings (gear) â†’ Advanced Settings     â”‚
â”‚     â†’ Camera Account                                            â”‚
â”‚  âœ… Create username and password                                â”‚
â”‚  ğŸ’¡ This is DIFFERENT from your TP-Link account!                â”‚
â”‚                                                                 â”‚
â”‚  STEP 3: Reboot Camera                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  ğŸ”Œ Physically unplug and replug the camera                     â”‚
â”‚  â±ï¸  Wait 30 seconds for it to reconnect                        â”‚
â”‚  âœ… Ports will now be open (554, 2020, 443, 8800)               â”‚
â”‚                                                                 â”‚
â”‚  STEP 4: Note Your Camera IP                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  ğŸ“ Camera Settings â†’ Device Info â†’ IP Address                  â”‚
â”‚  ğŸ’¡ Or run: ./scripts/discover_camera.sh                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Visual Guide:**

| Step | Screenshot |
|------|------------|
| Third-Party Compatibility | ![Third-Party](ui-exploration/screenshots/2026-01-11-discoveries/01-third-party-compatibility-off.png) |
| Camera Account Warning | ![Warning](ui-exploration/screenshots/2026-01-11-discoveries/07-camera-account-setup-warning.jpg) |

### 2. Discover Camera IP

```bash
./scripts/discover_camera.sh
# Output: 192.168.29.183
```

### 3. Test RTSP Stream

```bash
# Capture a frame
ffmpeg -rtsp_transport tcp \
  -i "rtsp://prabhanshu:iamapantar@192.168.29.183/stream1" \
  -frames:v 1 -update 1 /tmp/frame.jpg

# View with VLC
vlc "rtsp://prabhanshu:iamapantar@192.168.29.183/stream1"
```

## ğŸ“¡ Network Ports

| Port | Protocol | Purpose |
|------|----------|---------|
| 443 | HTTPS | Camera control API |
| 554 | RTSP | Video streaming |
| 2020 | ONVIF | Motion detection |
| 8800 | Proprietary | TP-Link binary protocol |

## ğŸ”§ Features

### Working âœ…
- **RTSP video streaming** - Direct HD/SD access
- **Camera discovery** - Auto-find camera on network
- **PAN/TILT controls** - Via Android emulator
- **Photo/video capture** - Via emulator
- **UI automation** - Full Tapo app control

### Emulator Quirks âš ï¸
- Video feed blacks out (MQTT issue) - Use RTSP instead
- ANR on live view - Use Me tab for playback access
- PAG library causes main thread blocking

## ğŸ› ï¸ Installation

```bash
# Clone
git clone https://github.com/prabhanshu11/tapo-c210-monitor.git
cd tapo-c210-monitor

# Install dependencies
uv sync

# Configure
cp .env.example .env
# Edit with your camera details
```

## ğŸ“‹ Configuration

```bash
# .env file
TAPO_HOST=192.168.29.183
TAPO_USERNAME=prabhanshu
TAPO_PASSWORD=iamapantar
```

## ğŸŒ Web UI Setup

Launch the configuration web interface:

```bash
uv run python -m tapo_c210_monitor.webui.app
# Open http://localhost:8080
```

The web UI provides:
- Step-by-step mobile app setup checklist
- Camera credential input
- Auto-discovery of camera on network
- RTSP connection testing
- Configuration file generation

## ğŸ® Usage

### Python Discovery

```python
from tapo_c210_monitor.discovery import discover_camera, get_rtsp_url

# Find camera
camera_ip = discover_camera()
print(f"Found: {camera_ip}")

# Get RTSP URL
url = get_rtsp_url(camera_ip)
print(f"RTSP: {url}")
```

### CLI Commands

```bash
# Test camera connection
uv run python main.py test-camera

# Take snapshot
uv run python main.py snapshot --output capture.jpg

# Sync recordings
uv run python main.py sync --days 7
```

### Android Emulator Control

```bash
# Start emulator
~/Android/Sdk/emulator/emulator -avd tapo_playstore -gpu host

# Launch Tapo app
adb shell am start -n com.tplink.iot/.view.welcome.StartupActivity

# Navigate to camera (dp coordinates)
adb shell input tap 85 220

# PAN left
adb shell input tap 108 592
```

## ğŸ“ Project Structure

```
tapo-c210-monitor/
â”œâ”€â”€ src/tapo_c210_monitor/
â”‚   â”œâ”€â”€ discovery.py          # Camera IP discovery
â”‚   â”œâ”€â”€ android/
â”‚   â”‚   â”œâ”€â”€ controller.py     # ADB wrapper
â”‚   â”‚   â”œâ”€â”€ camera_controls.py # PTZ coordinates
â”‚   â”‚   â””â”€â”€ tapo_automator.py # UI automation
â”‚   â””â”€â”€ vision/
â”‚       â””â”€â”€ llm_vision.py     # OpenRouter vision API
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ discover_camera.sh    # Network scanner
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ TAPO_APP_INTERNALS.md # How Tapo app works
â”œâ”€â”€ ui-exploration/
â”‚   â”œâ”€â”€ screens/              # UI documentation
â”‚   â”œâ”€â”€ screenshots/          # Reference images
â”‚   â””â”€â”€ NAVIGATION_QUICK_REF.md
â””â”€â”€ README.md
```

## ğŸ“– Documentation

- **[TAPO_APP_INTERNALS.md](docs/TAPO_APP_INTERNALS.md)** - How the Tapo app works internally
- **[CONVERSATION_HISTORY.md](CONVERSATION_HISTORY.md)** - Project development timeline
- **[NAVIGATION_QUICK_REF.md](ui-exploration/NAVIGATION_QUICK_REF.md)** - UI tap coordinates
- **[SESSION_2026-01-11.md](ui-exploration/SESSION_2026-01-11.md)** - Breakthrough session notes

## ğŸ”¬ Key Discoveries

1. **MQTT is the video bottleneck** - App uses MQTT via cloud, fails on emulator
2. **RTSP bypasses this** - Direct local access works perfectly
3. **Three steps for RTSP** - Toggle + Account + Reboot (all required!)
4. **PAG causes ANR** - Tencent animation library blocks main thread
5. **Two auth systems** - Cloud (TP-Link) vs Local (Camera Account)

## ğŸ¯ Roadmap

- [x] RTSP streaming
- [x] Camera discovery
- [x] PAN/TILT control via emulator
- [ ] Visual change detection
- [ ] Claude Agent SDK integration
- [ ] Gas knob monitoring experiment
- [ ] Multi-camera support

## ğŸ“š References

- [pytapo](https://github.com/JurajNyiri/pytapo) - Python library for Tapo cameras
- [HomeAssistant-Tapo-Control](https://github.com/JurajNyiri/HomeAssistant-Tapo-Control) - HA integration
- [TP-Link RTSP FAQ](https://www.tp-link.com/us/support/faq/2680/)

---

<p align="center">
  <i>Built for the intelligent home automation vision</i><br>
  <code>omarchy-voice-typing</code> + <code>tapo-c210-monitor</code> + <code>Claude Agent SDK</code>
</p>
